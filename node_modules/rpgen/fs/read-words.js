
"use strict"




const fs         = require('fs')
const readline   = require('readline')
const constants  = require('rpgen/commons/constants')





const createInterface = { }

createInterface.stdin = (_, callback) => {

	callback(
		readline.createInterface({
			input: process.stdin
		})
	)

}

createInterface.fpath = (fpath, callback) => {

	const isReadableFlag = fs.F_OK & fs.R_OK

	fs.access(fpath, isReadableFlag, err => {

		if (err.code === constants.errCodes.noEntry) {

			process.stderr.write(`ERROR: could not read from ${fpath}; does the file exist?\n`)
			process.exit(1)

		}

		callback(fs.createReadStream(fpath))

	})

}





const readWords = (fpath, callback) => {

	var lines = [ ]

	createInterface[fpath ? 'fpath' : 'stdin'](fpath, iface => {

		iface
		.on('line', line => {
			lines.push(line)
		})
		.on('close', ( ) => {
			callback(null, lines)
		})

	})

}





module.exports = readWords
